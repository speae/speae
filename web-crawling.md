### ğŸ¤”

web-crawling 1ë¶€
=====================================================================================================================================

ì§ì¥ì¸ì„ ìœ„í•œ ë°ì´í„°ë¶„ì„ ì‹¤ë¬´ [07. ì–´ë–¤ ë¬´ì„ ì²­ì†Œê¸°ê°€ ì¸ê¸°ê°€ ì¢‹ì„ê¹Œ?]ì— ëŒ€í•œ ê³ ì°°â‘  
-------------------------------------------------------------------------------------

  'ì§ì¥ì¸ì„ ìœ„í•œ ë°ì´í„°ë¶„ì„ ì‹¤ë¬´'ëŠ” ë¶„ëª… ë‚˜ê°™ì€ ì›¹ í¬ë¡¤ë§ì— ì…ë¬¸í•˜ëŠ” ì‚¬ëŒë“¤ì—ê²Œ ì¢‹ì€ ì±…ì¸ê±´ í™•ì‹¤í•˜ë‹¤. ë‹¨ í•˜ë‚˜, ì•„ì‰¬ìš´ ì ì€ ê±°ìŠ¬ë¦¬ëŠ” ì˜¤íƒ€ì™€ ì„¤ëª…ì´ í•„ìš”í•œ ë¶€ë¶„ë“¤ì€ ìƒëµëë‹¤ëŠ” ì ì´ë‹¤.
 
 ì´ë¥¼í…Œë©´, 
 
 ```python
  
  from selenium import webdriver
  browser = webdriver.Chrome('C:/playwithdata/chromedriver.exe')
  url = "http://search.danawa.com/dsearch.php?query=ë¬´ì„ ì²­ì†Œê¸°&tab=main"  
  driver.get(url)

```

ìœ„ ì½”ë“œì²˜ëŸ¼ browserì™€ driver ê°ê¸° ë‹¤ë¥¸ ë³€ìˆ˜ëª…ì„ ì‚¬ìš©í•˜ì—¬ ë…ìë“¤ì— í˜¼ë€ì„ ì£¼ê³  ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ìœ„ì˜ ì˜ˆì‹œë¥¼ ë‹¨ìˆœ ì˜¤íƒ€ë¡œ ë´ì•¼ í• ì§€ ë‹¤ë¥¸ ìƒê°ì´ ìˆì–´ì„œ ë‹¤ë¥¸ ê°ì²´ë¥¼ ì‚¬ìš©í–ˆëŠ”ë° ê·¸ì— ëŒ€í•œ ì„¤ëª…ì´ ë¶€ì¡±í–ˆë‹¤ê³  ë´ì•¼ í• ì§€ íŒë‹¨í•  ìˆ˜ ì—†ì—ˆì§€ë§Œ, í•„ìëŠ” ì•„ë¬´ë¦¬ ìƒê°í•´ë´ë„ êµ³ì´ ë‹¤ë¥¸ ê°ì²´ë¥¼ ì“¸ ì´ìœ ê°€ ì—†ë‹¤ê³  íŒë‹¨í•˜ê³  ì˜¤íƒ€ì˜ ì˜ˆì‹œë¡œ ë“¤ì—ˆë‹¤.

 ì„¤ëª…ì´ ë¶€ì¡±í•œ ë¶€ë¶„ì€ ë¬´ì—‡ì¼ê¹Œ...
 
  ```python
 
  !pip3 install openpyxl
  
  ```
 
 to_excel(), read_excel()ê³¼ ê°™ì€ ì—‘ì…€ê´€ë ¨ ë©”ì†Œë“œë“¤ì€ pandas íŒ¨í‚¤ì§€ë¿ ì•„ë‹ˆë¼ ì˜ì¡´ì„± íŒ¨í‚¤ì§€ì¸ openpyxl íŒ¨í‚¤ì§€ë¥¼ ìš”êµ¬í•œë‹¤. ì¦‰ ì´ ë©”ì†Œë“œë“¤ì„ ì‚¬ìš©í•˜ë ¤ë©´ openpyxlë¥¼ ë³„ë„ë¡œ ì„¤ì¹˜í•´ì£¼ì–´ì•¼ í•œë‹¤ëŠ” ê²ƒì´ë‹¤. ê·¸ëŸ°ë° ì´ ì±…ì—ì„œëŠ” pandasì˜ to_excel(), read_excel() í•¨ìˆ˜ë¥¼ í†µí•´ ì—‘ì…€ íŒŒì¼ë¡œ ì €ì¥í•˜ê³  ì½ëŠ”ë‹¤ê³  ì„¤ëª…í•˜ê³  ìˆë‹¤. openpyxl íŒ¨í‚¤ì§€ ì„¤ì¹˜ì— ëŒ€í•œ ì„¤ëª…ì´ ì—†ëŠ” íƒ“ì— ì¤‘ê°„ ê³¼ì •ì—†ì´ ì •ë³´ë¥¼ ì „ë‹¬í•œ ê²ƒì´ë‹¤. ìš°ë¦¬ëŠ” openpyxl íŒ¨í‚¤ì§€ë¥¼ ì¶”ê°€ë¡œ ì„¤ì¹˜í•¨ìœ¼ë¡œì¨, pandas ìì²´ë‚˜ pandasì˜ ë°ì´í„°í”„ë ˆì„ì„ ê°€ì§€ê³  openpyxl ë‚´ë¶€ì˜ í´ë˜ìŠ¤ë¥¼ í†µí•´ ì—‘ì…€ íŒŒì¼ì„ ë§Œë“¤ì–´ ì €ì¥í•˜ê±°ë‚˜ ì½ëŠ”ë‹¤ëŠ” ê²ƒì„ ì¶”ì¸¡í•  ìˆ˜ ìˆë‹¤.  
 
 ê·¸ë¦¬ê³  ë°ì´í„° ë¶„í¬ ê·¸ë˜í”„ ì„¤ëª… ë¶€ë¶„ì—ì„œ mean()ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ í‰ê· ê°’ì„ ê°€ì ¸ì™€ ê¸°ì¤€ì„ ìœ¼ë¡œ ê·¸ë¦°ë‹¤ê³  í–ˆëŠ”ë°, ì½”ë“œ ì„¤ëª…ì—ëŠ” ìµœì†Œê°’ ì •ë¦¬, ìµœì†Œê°’ì´ë¼ê³ ë§Œ ë‚˜ì™€ì„œ í˜¼ë€ì´ ìƒê¸¸ ìˆ˜ ìˆë‹¤. ì—„ì—°íˆ ìµœì†Œê°’ì€ ë”°ë¡œ ìˆê³  ì–´ë””ê¹Œì§€ë‚˜ í‰ê· ì„ ê¸°ì¤€ìœ¼ë¡œ ì‚¼ê² ë‹¤ëŠ” ê²ƒì„ ë°”ë¡œ 'ìµœì†Œê°’ êµ¬í•˜ê¸°'ë¼ê³  í•˜ë©´ ì˜ì•„í•˜ë‹¤ëŠ” ìƒê°ì´ ë“¤ ìˆ˜ ìˆë‹¤. 
 xì¶• ê¸°ì¤€ì„ ì˜ yì ˆí¸ì— ë˜‘ê°™ì€ ê°’ì„ ë„£ê³  ë°˜ëŒ€í¸ë„ ë˜‘ê°™ì´ í•´ì„œ ì¦ê°€ëŸ‰ = 0 = ê¸°ìš¸ê¸° -> ê¸°ì¤€ì„ ìœ¼ë¡œ ë§Œë“¤ì—ˆë‹¤ëŠ” ì„¤ëª…ê¹Œì§„ êµ³ì´ ì•ˆ ë„£ì–´ë„ ë˜ì§€ë§Œ, ë°”ë¡œ í‰ê· ê°’ì„ êµ¬í•˜ëŠ” ì½”ë“œì— ìµœì†Œê°’ êµ¬í•˜ê¸°ë¼ê³  í•˜ë©´ ë„ˆë¬´ ì„¤ëª…ì„ ì¶•ì†Œí•˜ê³  ì˜ëª»ëœ ì •ë³´ë¥¼ ì „ë‹¬í•˜ëŠ” ê²ƒì²˜ëŸ¼ ëŠê»´ì§„ë‹¤.  

ì§ì¥ì¸ì„ ìœ„í•œ ë°ì´í„°ë¶„ì„ ì‹¤ë¬´ [07. ì–´ë–¤ ë¬´ì„ ì²­ì†Œê¸°ê°€ ì¸ê¸°ê°€ ì¢‹ì„ê¹Œ?]ì— ëŒ€í•œ ê³ ì°°â‘¡
-------------------------------------------------------------------------------------

  ì½”ë“œ ì‹¤í–‰ ë¶€ë¶„ì„ ë³´ë©´ ì•„ì‰¬ìš´ ì ì´ ìˆë‹¤. ë°˜ë³µë¬¸ìœ¼ë¡œ ê²€ìƒ‰ ê²°ê³¼ì˜ 1í˜ì´ì§€ì— ëŒ€í•œ ìƒí’ˆ ì •ë³´ë¥¼ ì¶”ì¶œ ì‹œ ê° ì…€ ë³„ ë°ì´í„°ë§ˆë‹¤ ì˜ˆì™¸ì²˜ë¦¬ë¥¼ í–ˆë‹¤ëŠ” ì ì´ë‹¤. 
  
  ```python
  def get_prod_items(prod_items): 
    prod_data = []
    for prod_item in prod_items: 
    # â‘  ìƒí’ˆëª… ê°€ì ¸ì˜¤ê¸° 
    try: 
      title = prod_item.select('p.prod_name > a')[0].text.strip() 
    except: 
      title = ''
    # â‘¡ ìŠ¤í™ ëª©ë¡ ê°€ì ¸ì˜¤ê¸° 
    try: 
      spec_list = prod_item.select('div.spec_list')[0] text.strip() 
    except: 
      spec_list = '' 
    # â‘¢ ê°€ê²© ì •ë³´ ê°€ì ¸ì˜¤ê¸° 
    try: 
      price = prod_item.select('li.rank_one > p.price_sect > a > strong')[0].text.strip().replace(",", "") 
    except: 
      price = 0 
      prod_data.append([title , spec_list, price]) 
  return prod_data

```
 
 í‰ìƒì‹œ tryë¬¸ì„ ì‹¤í–‰í•˜ë‹¤ê°€ ì—ëŸ¬ ë°œìƒ ì‹œ exceptë¬¸ì„ ì‹¤í–‰í•˜ëŠ” ê²ƒì´ try~exceptë¬¸ì˜ íŠ¹ì§•ì¸ë°, ì—¬ê¸°ì„  if~elifë¬¸ì²˜ëŸ¼ ì‘ì„±ë¼ìˆë‹¤. ê²°êµ­ titleì´ë“  spec_listì´ë“  priceì´ë“  í•œ ê³³ì—ì„œ ì—ëŸ¬ ë°œìƒì‹œ ì¼ê´„ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ë§ëŠ” ë°©ë²•ì´ ì•„ë‹ê¹Œ ìƒê°í•œë‹¤. titleì—ì„œ ì—ëŸ¬ ë°œìƒì‹œ titleì„ Nonetype('')ìœ¼ë¡œ ì²˜ë¦¬í•˜ì—¬ ì‹¤ì œ ì—‘ì…€ íŒŒì¼ì—ì„œ ë³¼ ë•Œ ë¹ˆ ì…€ë¡œ ì¶œë ¥í•˜ë„ë¡ í•œë‹¤ë©´ ë‹¹ì—°íˆ ë‚˜ë¨¸ì§€ ì…€ë“¤ì— ë¬´ìŠ¨ ê°’ì´ ë“¤ì–´ì˜¤ê±´ ì ˆëŒ€ ì €ì¥ë˜ì„  ì•ˆë˜ëŠ” ê°’ì´ë‹¤. ê·¸ëŸ° ì˜ë¯¸ì—ì„œ ë‚˜ë¨¸ì§€ ì…€ ë“¤ì— ë“¤ì–´ê°ˆ ë°ì´í„°ë“¤ë„ ëª¨ë‘ Noneìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ë°”ëŒì§í•˜ë‹¤ê³  ë³¸ë‹¤.

```python3

# ìƒí’ˆ ì •ë³´ íƒœê·¸ì—ì„œ ì›í•˜ëŠ” ì •ë³´ë¥¼ ì¶”ì¶œí•˜ëŠ” í•¨ìˆ˜
def get_prod_items(prod_items):
    prod_data = []
    none_data = []
    
    for prod_item in prod_items:
        try: 
            # ìƒí’ˆëª… ê°€ì ¸ì˜¤ê¸°
            title = prod_item.select('p.prod_name > a')[0].text.strip()
            # ìŠ¤í™ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
            spec_list = prod_item.select('div.spec_list')[0].text.strip()
            # ê°€ê²© ì •ë³´ ê°€ì ¸ì˜¤ê¸°
            price = prod_item.select('li.rank_one > p.price_sect > a > strong')[0].text.strip().replace(",", "")
        
        # prod_nameì—ì„œ ìƒí’ˆëª…, ìŠ¤í™ ëª©ë¡, ê°€ê²© ì •ë³´ ì—†ì´ ë¹ˆ ë°•ìŠ¤ ìƒíƒœë§Œ ìˆëŠ” ê²½ìš° ì¡´ì¬ -> ì“°ë ˆê¸° ë°ì´í„° ë²„ë¦¬ê¸°
        except Exception as ex:
            print(ex)
            title = None
            spec_list = None
            price = None
            none_data.append([title, spec_list, price])
            
        # Nonetype error ë°©ì§€ì™€ '/'ì´ ìˆëŠ” ë°ì´í„°ë§Œ ì €ì¥
        if spec_list is not None and '/' in spec_list:   
            if not price.isdigit():
                price = 0
            prod_data.append([title, spec_list, int(price)])
            
    return prod_data
    
 ```
  none_dataë¼ëŠ” ë°°ì—´ì„ ë§Œë“¤ì–´ì„œ ê·¸ ì•ˆì— None ë°ì´í„°ë“¤ì„ ëª¨ì•„ ë„£ì„ ê²ƒì´ë‹¤. ì´ë ‡ê²Œ ë˜ë©´ í•¨ìˆ˜ ë‚´ì—ì„œë§Œ none_dataì— None typeì˜ ë°ì´í„°ë“¤ë§Œì´ ë“¤ì–´ê°€ëŠ”ê±¸ ë°˜ë³µí•˜ê³  ì–´ëŠ ê³³ì—ì„œë„ ì“°ì´ì§€ ì•Šê³  ëë‚  ê²ƒì´ë‹¤.

![prod_item_1](https://user-images.githubusercontent.com/43712685/130160921-5961a5ab-a664-4ff8-99e6-dd66115201d4.png)

<prod_item â‘  : p íƒœê·¸ì˜ classê°€ ìˆëŠ” ìƒí’ˆ1>

![prod_item_2](https://user-images.githubusercontent.com/43712685/130225210-c2b51eef-8594-44b7-9770-29d53e509f54.png)

<prod_item â‘¡ : p íƒœê·¸ì˜ classê°€ ìˆëŠ” ìƒí’ˆ2>

![spec_list](https://user-images.githubusercontent.com/43712685/130225288-7047895b-8ba8-4502-a323-bd19677aaba2.png)

<spec_list : div íƒœê·¸ì˜ classê°€ ìˆëŠ” ìƒí’ˆ>

![prod_item_None](https://user-images.githubusercontent.com/43712685/130225559-59740ce8-2702-4138-9f04-8903157e1599.png)

<prod_item is None : p íƒœê·¸ì˜ classì¸ prod_nameì´ ì¡´ì¬í•˜ì§€ë§Œ, spec_list ë“±ì´ ì—†ëŠ” ì“¸ëª¨ì—†ëŠ” ì •ë³´>
